# Minimum version de CMake
cmake_minimum_required(VERSION 3.20)

# Nom du projet
project(e_tron)

# Définir le standard C++
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Flags
set(CXX_FLAGS_DEFAULT "/MP /Ot /fp:fast")
set(CMAKE_CXX_FLAGS_RELEASE "${CXX_FLAGS_DEFAULT} /MD")
set(CMAKE_CXX_FLAGS_DEBUG "${CXX_FLAGS_DEFAULT} /MDd")

# Inclure les répertoires contenant les headers
include_directories(${CMAKE_SOURCE_DIR}/src)

# Ajouter les fichiers sources principaux
file(GLOB_RECURSE DEFAULT_PROJECT_FILES ${CMAKE_SOURCE_DIR}/src/*.cpp ${CMAKE_SOURCE_DIR}/src/*.h)

# Ajouter les fichiers pour les tests (dans src/test/)
file(GLOB_RECURSE TEST_FILES ${CMAKE_SOURCE_DIR}/src/testMain.cpp ${CMAKE_SOURCE_DIR}/src/test/*.cpp ${CMAKE_SOURCE_DIR}/src/test/*.h)

# Ajouter les fichiers pour le graphics
file(GLOB_RECURSE GRAPHICS_FILES ${CMAKE_SOURCE_DIR}/src/winMain.cpp ${CMAKE_SOURCE_DIR}/src/graphics/*.cpp ${CMAKE_SOURCE_DIR}/src/graphics/*.h)

# Build de la liste des fichiers sources
list(REMOVE_ITEM DEFAULT_PROJECT_FILES ${CMAKE_SOURCE_DIR}/src/main.cpp)
list(REMOVE_ITEM DEFAULT_PROJECT_FILES ${GRAPHICS_FILES})
list(REMOVE_ITEM DEFAULT_PROJECT_FILES ${TEST_FILES})

# Ajouter des cibles exécutable
add_executable(MyTests ${DEFAULT_PROJECT_FILES} ${TEST_FILES})

add_executable(e_tron_cmd ${DEFAULT_PROJECT_FILES} ${CMAKE_SOURCE_DIR}/src/main.cpp)

add_executable(e_tron_directX ${DEFAULT_PROJECT_FILES} ${GRAPHICS_FILES})

set_target_properties(e_tron_directX PROPERTIES LINK_FLAGS "/SUBSYSTEM:WINDOWS")
target_sources(e_tron_directX PRIVATE ${CMAKE_SOURCE_DIR}/src/graphics/resource/resource.rc)

target_link_libraries(e_tron_directX PRIVATE d3d11 d3dcompiler dxgi dxguid)


